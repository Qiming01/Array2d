# Array2D - äºŒç»´æ•°ç»„å®¹å™¨

[![Build Status](https://img.shields.io/badge/build-passing-brightgreen)](https://github.com/your-repo/array2d)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![C++](https://img.shields.io/badge/C++-20-blue.svg)](https://en.cppreference.com/w/cpp/20)
[![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20Linux%20%7C%20macOS-lightgrey)](https://github.com/your-repo/array2d)

`array2d` æ˜¯ä¸€ä¸ª C++20 äºŒç»´æ•°ç»„ï¼Œå°è£…äº†æ ‡å‡†åº“ `std::vector`ï¼Œæä¾›äº†ç›´è§‚çš„çŸ©é˜µæ“ä½œæ¥å£å’Œä¼˜åŒ–çš„å†…å­˜ç®¡ç†ã€‚

> [!WARNING]
> ä»£ç ä½¿ç”¨ AI è¾…åŠ©ç”Ÿæˆï¼Œå·²é€šè¿‡æµ‹è¯•ã€‚

## âœ¨ ç‰¹æ€§

- ğŸš€ **é«˜æ€§èƒ½**: è¿ç»­å†…å­˜å­˜å‚¨ï¼Œç¼“å­˜å‹å¥½çš„ç®—æ³•å®ç°
- ğŸ›¡ï¸ **ç±»å‹å®‰å…¨**: ä½¿ç”¨ C++20 æ¦‚å¿µè¿›è¡Œç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
- ğŸ§© **STL å…¼å®¹**: å®Œæ•´çš„è¿­ä»£å™¨æ”¯æŒï¼Œå…¼å®¹æ ‡å‡†ç®—æ³•
- ğŸ”§ **æ˜“äºä½¿ç”¨**: ç›´è§‚çš„ API è®¾è®¡ï¼Œæ”¯æŒå¤šç§åˆå§‹åŒ–æ–¹å¼  
- ğŸ”„ **ç§»åŠ¨è¯­ä¹‰**: å®Œæ•´çš„ç§»åŠ¨è¯­ä¹‰æ”¯æŒ

## ğŸ“‹ ç›®å½•

- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [å®‰è£…](#-å®‰è£…)
- [åŸºæœ¬ç”¨æ³•](#-åŸºæœ¬ç”¨æ³•)
- [é«˜çº§ç‰¹æ€§](#-é«˜çº§ç‰¹æ€§)
- [API å‚è€ƒ](#-api-å‚è€ƒ)
- [è®¸å¯è¯](#-è®¸å¯è¯)

## ğŸš€ å¿«é€Ÿå¼€å§‹

```cpp
#include "array2d.hpp"
using namespace qm;

int main() {
    // åˆ›å»º 3x4 çŸ©é˜µå¹¶åˆå§‹åŒ–ä¸º 0
    array2d<int> matrix(3, 4);
    
    // ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨åˆ›å»ºçŸ©é˜µ
    array2d<double> mat{{1.0, 2.0, 3.0},
                        {4.0, 5.0, 6.0}};
    
    // è®¿é—®å…ƒç´ 
    mat[0][1] = 2.5;        // ä½¿ç”¨ operator[]
    mat(1, 2) = 6.5;        // ä½¿ç”¨ operator()
    
    // å®‰å…¨è®¿é—®ï¼ˆå¸¦è¾¹ç•Œæ£€æŸ¥ï¼‰
    try {
        double val = mat.at(1, 2);
    } catch (const std::out_of_range& e) {
        // å¤„ç†è¶Šç•Œè®¿é—®
    }
    
    // éå†çŸ©é˜µ
    for (auto& element : mat) {
        element *= 2;
    }
    
    return 0;
}
```

## ğŸ“¦ å®‰è£…

### å¤´æ–‡ä»¶å¼•å…¥

`array2d` æ˜¯ä¸€ä¸ªå¤´æ–‡ä»¶åº“ï¼Œåªéœ€è¦åŒ…å«å¤´æ–‡ä»¶å³å¯ï¼š

```cpp
#include "array2d.hpp"
#include "array2d_iterator.hpp"  // å¦‚æœéœ€è¦è‡ªå®šä¹‰è¿­ä»£å™¨
```


### ä¾èµ–è¦æ±‚

- **ç¼–è¯‘å™¨**: æ”¯æŒ C++20 çš„ç¼–è¯‘å™¨
  - GCC 10+ 
  - Clang 12+
  - MSVC 19.29+ (Visual Studio 2019 16.10+)
- **æ ‡å‡†åº“**: æ”¯æŒ C++20 æ ‡å‡†åº“ç‰¹æ€§

## ğŸ“– åŸºæœ¬ç”¨æ³•

### åˆ›å»ºçŸ©é˜µ

```cpp
// é»˜è®¤æ„é€ ï¼ˆç©ºçŸ©é˜µï¼‰
array2d<int> empty_matrix;

// æŒ‡å®šå°ºå¯¸ï¼ˆé»˜è®¤åˆå§‹åŒ–ï¼‰
array2d<double> matrix1(5, 3);

// æŒ‡å®šå°ºå¯¸å’Œåˆå€¼
array2d<int> matrix2(4, 4, 42);

// åˆå§‹åŒ–åˆ—è¡¨æ„é€ 
array2d<float> matrix3{{1.0f, 2.0f}, 
                       {3.0f, 4.0f}};

// ä»å®¹å™¨æ„é€ 
std::vector<int> data{1, 2, 3, 4, 5, 6};
array2d<int> matrix4(2, 3, data);

// ç±»æ¨¡æ¿å‚æ•°æ¨å¯¼ (C++17)
auto matrix5 = array2d{{1, 2, 3},
                       {4, 5, 6}};  // æ¨å¯¼ä¸º array2d<int>
```

### å…ƒç´ è®¿é—®

```cpp
array2d<int> mat(3, 3, 0);

// å¤šç§è®¿é—®æ–¹å¼
mat[0][1] = 10;          // operator[] - å¿«é€Ÿè®¿é—®
mat(1, 2) = 20;          // operator() - å‡½æ•°å¼è®¿é—®  
mat.at(2, 0) = 30;       // at() - å®‰å…¨è®¿é—®ï¼ˆè¾¹ç•Œæ£€æŸ¥ï¼‰

// å¸¸é‡è®¿é—®
const auto& const_mat = mat;
int val = const_mat[0][1];
```

### è¿­ä»£å™¨æ”¯æŒ

```cpp
array2d<int> mat{{1, 2, 3}, {4, 5, 6}};

// èŒƒå›´ for å¾ªç¯
for (auto& elem : mat) {
    elem *= 2;
}

// STL ç®—æ³•
auto it = std::find(mat.begin(), mat.end(), 8);
std::sort(mat.begin(), mat.end());

// åå‘è¿­ä»£
for (auto it = mat.rbegin(); it != mat.rend(); ++it) {
    std::cout << *it << " ";
}

// è¡Œè¿­ä»£
for (auto& elem : mat.row_range(0)) {
    elem += 10;  // åªä¿®æ”¹ç¬¬ä¸€è¡Œ
}
```

### åŸºæœ¬æ“ä½œ

```cpp
array2d<double> mat(4, 3, 1.0);

// æŸ¥è¯¢ä¿¡æ¯
std::cout << "Rows: " << mat.rows() << std::endl;        // 4
std::cout << "Cols: " << mat.cols() << std::endl;        // 3  
std::cout << "Size: " << mat.size() << std::endl;        // 12
std::cout << "Empty: " << mat.empty() << std::endl;      // false
std::cout << "Square: " << mat.is_square() << std::endl; // false

// å¡«å……æ“ä½œ
mat.fill(3.14);           // å¡«å……æ‰€æœ‰å…ƒç´ 
mat.reset();              // é‡ç½®ä¸ºé»˜è®¤å€¼
mat.fill_row(0, 2.71);    // åªå¡«å……ç¬¬ä¸€è¡Œ

// å°ºå¯¸è°ƒæ•´
mat.resize(5, 4);         // è°ƒæ•´ä¸º 5x4ï¼Œä¿ç•™åŸæœ‰æ•°æ®
mat.resize(3, 3, 0.0);    // è°ƒæ•´ä¸º 3x3ï¼Œæ–°å…ƒç´ ç”¨ 0.0 å¡«å……
```

## ğŸ”§ é«˜çº§ç‰¹æ€§

### Span å’Œè§†å›¾æ“ä½œ

```cpp
array2d<int> mat{{1, 2, 3, 4},
                 {5, 6, 7, 8},
                 {9, 10, 11, 12}};

// è·å–æ•´ä¸ªçŸ©é˜µçš„ span
auto full_span = mat.as_span();

// è·å–ç‰¹å®šè¡Œçš„ span
auto row1_span = mat.row(1);  // [5, 6, 7, 8]

// è·å–åˆ—æ•°æ®ï¼ˆéœ€è¦å¤åˆ¶ï¼Œå› ä¸ºä¸è¿ç»­ï¼‰
auto col2_data = mat.col(2);  // [3, 7, 11]

// å­çŸ©é˜µè§†å›¾ï¼ˆè¡Œä¼˜å…ˆè¿ç»­éƒ¨åˆ†ï¼‰
auto sub_span = mat.submatrix_row_major(1, 0, 2, 4);  // ç¬¬1-2è¡Œå®Œæ•´æ•°æ®
```

### è¡Œæ“ä½œ

```cpp
array2d<int> mat(4, 3);

// è¡Œå¤åˆ¶
mat.copy_row(0, 1);      // å°†ç¬¬0è¡Œå¤åˆ¶åˆ°ç¬¬1è¡Œ

// è¡Œäº¤æ¢  
mat.swap_rows(1, 3);     // äº¤æ¢ç¬¬1è¡Œå’Œç¬¬3è¡Œ

// è¡Œå¡«å……
mat.fill_row(2, 42);     // å°†ç¬¬2è¡Œå¡«å……ä¸º42
```

### çŸ©é˜µå˜æ¢

```cpp
// æ–¹é˜µå°±åœ°è½¬ç½®
array2d<double> square_mat(3, 3);
square_mat.transpose();  // å°±åœ°è½¬ç½®

// ä»»æ„å°ºå¯¸çŸ©é˜µè½¬ç½®ï¼ˆè¿”å›æ–°çŸ©é˜µï¼‰
array2d<int> rect_mat(2, 3);
auto transposed = rect_mat.transposed();  // 3x2 çŸ©é˜µ
```

### å†…å­˜ç®¡ç†ä¼˜åŒ–

```cpp
array2d<int> mat;

// é¢„åˆ†é…å†…å­˜
mat.reserve(1000, 1000);  // ä¸º100ä¸‡å…ƒç´ é¢„åˆ†é…å†…å­˜

// é‡Šæ”¾å¤šä½™å†…å­˜
mat.shrink_to_fit();

// è·å–åº•å±‚æ•°æ®æŒ‡é’ˆ
int* data_ptr = mat.data();
```

### å¹¶è¡Œæ“ä½œ

```cpp
array2d<double> large_mat(10000, 10000);

// å¹¶è¡Œå¡«å……ï¼ˆè‡ªåŠ¨åˆ¤æ–­æ˜¯å¦ä½¿ç”¨å¹¶è¡Œï¼‰
large_mat.fill_parallel(3.14159);
```

### è‡ªå®šä¹‰ç´¢å¼•ç±»å‹

```cpp
// ä½¿ç”¨ long ä½œä¸ºç´¢å¼•ç±»å‹
array2d<double, long> big_matrix(1000000L, 1000000L);

// ä½¿ç”¨ short èŠ‚çœå†…å­˜ï¼ˆå°çŸ©é˜µï¼‰
array2d<int, short> small_matrix(100, 100);
```

## ğŸ“š API å‚è€ƒ

### æ„é€ å‡½æ•°

| æ„é€ å‡½æ•° | æè¿° |
|----------|------|
| `array2d()` | é»˜è®¤æ„é€ ï¼Œåˆ›å»ºç©ºçŸ©é˜µ |
| `array2d(rows, cols)` | åˆ›å»ºæŒ‡å®šå°ºå¯¸çš„çŸ©é˜µ |
| `array2d(rows, cols, value)` | åˆ›å»ºçŸ©é˜µå¹¶ç”¨æŒ‡å®šå€¼åˆå§‹åŒ– |
| `array2d({...})` | åˆå§‹åŒ–åˆ—è¡¨æ„é€  |
| `array2d(rows, cols, container)` | ä»å®¹å™¨æ•°æ®æ„é€  |

### å…ƒç´ è®¿é—®

| æ–¹æ³• | æè¿° | å¼‚å¸¸å®‰å…¨ |
|------|------|----------|
| `operator[](row)` | è¿”å›è¡ŒæŒ‡é’ˆï¼Œæ”¯æŒ `mat[i][j]` | æ— è¾¹ç•Œæ£€æŸ¥ |
| `operator()(row, col)` | ç›´æ¥è®¿é—®å…ƒç´  | æ— è¾¹ç•Œæ£€æŸ¥ |
| `at(row, col)` | å®‰å…¨è®¿é—®å…ƒç´  | æŠ›å‡º `std::out_of_range` |

### è¿­ä»£å™¨

| æ–¹æ³• | æè¿° |
|------|------|
| `begin()`, `end()` | æ­£å‘è¿­ä»£å™¨ |
| `cbegin()`, `cend()` | å¸¸é‡æ­£å‘è¿­ä»£å™¨ |
| `rbegin()`, `rend()` | åå‘è¿­ä»£å™¨ |
| `row_range(row)` | è¡ŒèŒƒå›´è¿­ä»£å™¨ |

### å®¹é‡å’Œå°ºå¯¸

| æ–¹æ³• | æè¿° |
|------|------|
| `rows()`, `cols()` | è·å–è¡Œæ•°/åˆ—æ•° |
| `size()` | è·å–æ€»å…ƒç´ æ•° |
| `empty()` | æ£€æŸ¥æ˜¯å¦ä¸ºç©º |
| `is_square()` | æ£€æŸ¥æ˜¯å¦ä¸ºæ–¹é˜µ |
| `capacity()` | è·å–å®¹é‡ |
| `reserve(rows, cols)` | é¢„åˆ†é…å†…å­˜ |
| `shrink_to_fit()` | é‡Šæ”¾å¤šä½™å†…å­˜ |

### æ•°æ®æ“ä½œ

| æ–¹æ³• | æè¿° |
|------|------|
| `fill(value)` | å¡«å……æ‰€æœ‰å…ƒç´  |
| `fill_parallel(value)` | å¹¶è¡Œå¡«å…… |
| `reset(option)` | é‡ç½®å†…å­˜ |
| `resize(rows, cols)` | è°ƒæ•´å°ºå¯¸ |

### è¡Œæ“ä½œ

| æ–¹æ³• | æè¿° |
|------|------|
| `copy_row(src, dest)` | å¤åˆ¶è¡Œ |
| `swap_rows(row1, row2)` | äº¤æ¢è¡Œ |
| `fill_row(row, value)` | å¡«å……è¡Œ |

### è§†å›¾å’Œ Span

| æ–¹æ³• | æè¿° |
|------|------|
| `as_span()` | æ•´ä¸ªçŸ©é˜µçš„ span |
| `row(index)` | è¡Œ span |
| `col(index)` | åˆ—æ•°æ®ï¼ˆvectorï¼‰ |
| `submatrix_row_major(...)` | å­çŸ©é˜µ span |

### å˜æ¢æ“ä½œ

| æ–¹æ³• | æè¿° |
|------|------|
| `transpose()` | å°±åœ°è½¬ç½®ï¼ˆä»…æ–¹é˜µï¼‰ |
| `transposed()` | è¿”å›è½¬ç½®çŸ©é˜µ |


## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

---

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­ï¼**